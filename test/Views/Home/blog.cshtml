@{
    ViewBag.Title = "blog";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section id="intro" class="padding-large jarallax">
    <div class="container">
        <div class="row">
            <div class="col-md-7">
                <div class="section-title my-5">
                    <div class="breadcrumb text-white">
                        <span class="item"><a href="/Home/Index" class="text-white">Home</a></span> &nbsp; / &nbsp;
                        <span class="item">Fundraiser</span>
                    </div>
                    <h2 class="text-white display-2">Browse Fundraiser</h2>
                </div>

            </div>
        </div>
    </div>

    <div id="jarallax-container-0"
         style="position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; overflow: hidden; z-index: -100; clip-path: polygon(0px 0px, 100% 0px, 100% 100%, 0px 100%);">
        <img src="~/Content/images/banner.jpg" class="jarallax-img"
             style="object-fit: cover; object-position: 50% 50%; max-width: none; position: fixed; top: 0px; left: 0px; width: 1310.4px; height: 665.5px; overflow: hidden; pointer-events: none; transform-style: preserve-3d; backface-visibility: hidden; will-change: transform, opacity; margin-top: 72.75px; transform: translate3d(0px, -72.75px, 0px);">
    </div>
</section>


<section class="browse-section" role="region" aria-label="GoFundMe categories" tabindex="0"
         data-testid="gfm-categories-wrapper">

    <h2 class="heading-2 text-center mb3x" data-testid="gfm-categories-header">
        Browse fundraisers by
        category
    </h2>

    <div class="section-categories grid-x small-up-2 medium-up-3 large-up-6">
        <a href="../discover/medical-fundraiser" role="button" class="section-categories-icon cell text-center"
           data-testid="gfm-categories-icon"
           data-gfm-analytics-element="btn_category_grid_discovermedical-fundraiser">
            <div class="cat-ico cat-ico--medical" aria-hidden="true"></div>
            <div class="text-black">Medical</div>
        </a>
        <a href="..//discover/memorial-fundraiser" role="button" class="section-categories-icon cell text-center"
           data-testid="gfm-categories-icon"
           data-gfm-analytics-element="btn_category_grid_discovermemorial-fundraiser">
            <div class="cat-ico cat-ico--memorial" aria-hidden="true"></div>
            <div class="text-black">Memorial</div>
        </a>
        <a href="..//discover/emergency-fundraiser" role="button" class="section-categories-icon cell text-center"
           data-testid="gfm-categories-icon"
           data-gfm-analytics-element="btn_category_grid_discoveremergency-fundraiser">
            <div class="cat-ico cat-ico--emergency" aria-hidden="true"></div>
            <div class="text-black">Emergency</div>
        </a>
        <a href="../discover/charity-fundraiser" role="button" class="section-categories-icon cell text-center"
           data-testid="gfm-categories-icon"
           data-gfm-analytics-element="btn_category_grid_discovercharity-fundraiser">
            <div class="cat-ico cat-ico--charity" aria-hidden="true"></div>
            <div class="text-black">Nonprofit</div>
        </a>
        <a href="../discover/education-fundraiser" role="button" class="section-categories-icon cell text-center"
           data-testid="gfm-categories-icon"
           data-gfm-analytics-element="btn_category_grid_discovereducation-fundraiser">
            <div class="cat-ico cat-ico--education" aria-hidden="true"></div>
            <div class="text-black">Education</div>
        </a>
        <a href="../discover/animal-fundraiser" role="button" class="section-categories-icon cell text-center"
           data-testid="gfm-categories-icon"
           data-gfm-analytics-element="btn_category_grid_discoveranimal-fundraiser">
            <div class="cat-ico cat-ico--animal" aria-hidden="true"></div>
            <div class="text-black">Animals</div>
        </a>
    </div>

</section>

<section id="latest-blog" class="scrollspy-section padding-large">

    <h2 class="heading-2 text-center mb3x blog-header" data-testid="gfm-categories-header">
        All Campaigns
    </h2>
    <div class="container">

        <div class="row">

            <div class="col-md-12">

                <!-- post grid -->
                <div class="post-grid">
                    <div class="row campaign-filter" data-masonry="{&quot;percentPosition&quot;: true }">

                        <div class="col-md-4">

                            <article class="post-item">

                                <figure>
                                    <div href="#" class="image-hvr-effect">
                                        <img src="~/Content/images/Capture.PNG"
                                             alt="post" class="post-image">
                                    </div>
                                </figure>

                                <div class="post-content">
                                    <div class="post-meta">Costa Mesa, CA</div>
                                    <h2 class="post-title">
                                        <a href="/Home/single_post">
                                            Help Lulu get new teeth and
                                            stability ❤️
                                        </a>
                                    </h2>
                                    <p>
                                        Lectus molestie id enim ipsum. Netus sed cursus nibh iaculis ipsum turpis
                                        nulla blandit dui.
                                    </p>
                                </div>
                                <div class="fund-item progress-bar-contain">
                                    <div class="progress-bar progress-bar-behind">
                                        <div class="progress-bar progress-bar-fill" style="width: 100%;"></div>
                                    </div>
                                </div>
                                <div class="fund-item truncate-single-line">
                                    <div class="show-for-medium">
                                        <strong>$50,717 raised</strong> of $20,000
                                    </div>
                                </div>
                            </article>

                        </div>


                    </div>
                </div>
                <!-- / post grid -->

            </div>

        </div>

    </div>
</section>


<script>
    function displayProducts(products) {
        let displayProducts = products.map(function (item) {
            return `<div class="col-md-4">

                            <article class="post-item">

                                <figure>
                                    <div href="#" class="image-hvr-effect">
                                        <img src="${item.Campaign_Img}" alt="post" class="post-image">
                                    </div>
                                </figure>

                                <div class="post-content">

                                <div class="post-meta">Created by ${item.Campaign_FullName} </div>
                                    <h2 class="post-title">
                                        <a href="/Home/single_post?p-id=${item.Campaign_ID}">
                                            ${item.Campaign_Title}
                                        </a>
                                    </h2>
                                    <p>
                                        ${item.Campaign_Story}
                                    </p>
                                </div>
                                <div class="fund-item progress-bar-contain">
                                    <div class="progress-bar progress-bar-behind">
                                        <div class="progress-bar progress-bar-fill" style="width: 100%;"></div>
                                    </div>
                                </div>
                                <div class="fund-item truncate-single-line">
                                    <div class="show-for-medium">
                                        <strong>$50,717 raised</strong> of $${item.Campaign_Goal}
                                    </div>
                                </div>
                            </article>

                        </div>`;
        });
        displayProducts = displayProducts.join("");

        document.querySelector(".campaign-filter").innerHTML = displayProducts;

    }

    $(document).ready(function () {
        let currentProducts = []

        $.ajax(
            {
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: window.location.origin + '/User/get_All',
                processData: false,
                contentType: false,
                cache: false,
                success: function (response) {
                    var rs = JSON.parse(response);

                    if (rs.ErrCode == 1) {
                        console.log(rs.Data)
                        const products = rs.Data
                        displayProducts(products)
                        currentProducts = products
                    }
                    else {
                        alert(rs.ErrDesc);
                    }
                },
                error: function (response) {
                    alert("Lấy DSSP thất bại");
                }
            }
        );

        document.getElementById("search-bar").addEventListener("input", (e) => {
            let input = e.target.value;

            input = input.toLowerCase();
            const filteredProducts = currentProducts.filter((item) => {
                if (item.NameProduct.toLowerCase().includes(input) || item.Price.toString().includes(input)) {
                    return item;
                }
            })

            displayProducts(filteredProducts);
        })
    })</script>